"use strict";

// 숫자 포맷팅 함수
function formatNumber(num) {
    if (isNaN(num)) return ""; // 숫자가 아니면 빈 문자열 반환
    return num.toLocaleString();
}

// 숫자 포맷 해제 함수
function unformatNumber(str) {
    if (typeof str !== 'string') return NaN;
    return Number(str.replace(/,/g, ""));
}

// 실시간 유효성 검사 함수
function validateInputs() {
    const loanAmount = document.getElementById('loanAmount').value.trim();
    const loanPeriod = document.getElementById('loanPeriod').value.trim();
    const interestRate = document.getElementById('interestRate').value.trim();
    const repaymentMethod = document.getElementById('repaymentMethod').value;

    let isValid = true;

    // 대출 금액 유효성 검사
    if (!loanAmount || isNaN(unformatNumber(loanAmount)) || unformatNumber(loanAmount) <= 0) {
        document.getElementById('loanAmountError').textContent = "유효한 대출 금액을 입력하세요.";
        isValid = false;
    } else {
        document.getElementById('loanAmountError').textContent = "";
    }

    // 대출 기간 유효성 검사
    if (!loanPeriod || isNaN(loanPeriod) || loanPeriod <= 0) {
        document.getElementById('loanPeriodError').textContent = "유효한 대출 기간을 입력하세요.";
        isValid = false;
    } else {
        document.getElementById('loanPeriodError').textContent = "";
    }

    // 이자율 유효성 검사
    if (!interestRate || isNaN(interestRate) || interestRate <= 0) {
        document.getElementById('interestRateError').textContent = "유효한 이자율을 입력하세요.";
        isValid = false;
    } else {
        document.getElementById('interestRateError').textContent = "";
    }

    // 상환 방식 선택 확인
    if (!repaymentMethod) {
        isValid = false; // 상환 방식이 선택되지 않으면 비활성화 유지
    }

    // 버튼 활성화/비활성화
    document.getElementById('calculateButton').disabled = !isValid;

    return isValid;
}

// 실시간 입력 이벤트 리스너 추가
document.querySelectorAll('#loanAmount, #loanPeriod, #interestRate, #repaymentMethod').forEach(input => {
    input.addEventListener('input', validateInputs);
});

// 대출 금액 포맷팅 적용
const loanAmountInput = document.getElementById('loanAmount');
if (loanAmountInput) {
    loanAmountInput.addEventListener('input', function () {
        this.value = formatNumber(unformatNumber(this.value));
        validateInputs();
    });
}

// 계산 함수
function calculateRepayment() {
    if (!validateInputs()) return;

    const loanAmountInput = document.getElementById('loanAmount').value.trim();
    const loanAmount = unformatNumber(loanAmountInput);
    const loanPeriodInput = document.getElementById('loanPeriod').value.trim();
    const loanPeriod = parseInt(loanPeriodInput);
    const interestRateInput = document.getElementById('interestRate').value.trim();
    const interestRate = parseFloat(interestRateInput) / 100;
    const repaymentMethod = document.getElementById('repaymentMethod').value;

    const resultDiv = document.getElementById("result");
    
    // 로딩 표시
    const loadingDiv = document.getElementById("loading");
    
    resultDiv.textContent = "";
    
    loadingDiv.style.display = "block";

    
//...
